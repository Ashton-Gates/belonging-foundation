{% block content %}
<h2>Application Review</h2>
{% for application in applications %}
  <div>
    <h3>{{ application.name }}</h3>
    <p>{{ application.summary }}</p>
    <!-- Add buttons for approve/disapprove actions -->
    <a href="{% url 'approve_application' application.id %}">Approve</a>
    <a href="{% url 'disapprove_application' application.id %}">Disapprove</a>
  </div>
{% empty %}
  <p>No applications to review.</p>
{% endfor %}
<script>
  function fetchApplications() {
    fetch('/internal/get-latest-applications/')
      .then(response => response.json())
      .then(data => {
        // Assume you have a div with id="applications-list" to display applications
        const applicationsList = document.getElementById('applications-list');
        applicationsList.innerHTML = ''; // Clear current list
        data.forEach(app => {
          // Create a new element for each application and add it to the list
          // This is a basic example; you might need to adjust based on your data structure
          const appElement = document.createElement('div');
          appElement.textContent = `Application ID: ${app.id}, Submitted: ${app.date_submitted}`;
          applicationsList.appendChild(appElement);
        });
      })
      .catch(error => console.error('Error fetching new applications:', error));
  }
  
  // Poll for new applications every 30 seconds
  setInterval(fetchApplications, 30000);
  
  // Also, fetch applications on page load
  document.addEventListener('DOMContentLoaded', fetchApplications);
  </script>

{% endblock %}